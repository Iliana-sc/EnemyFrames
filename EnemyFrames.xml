<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/..\FrameXML\UI.xsd">
    <Script file="Localization.lua"/>
    <Script file="EnemyFrames.lua"/>

	<Frame name="EnemyFrames" parent="UIParent" hidden="false">
		<Scripts>
			<OnLoad>
				EnemyFrames.OnLoad();
			</OnLoad>
            <OnEvent>
                EnemyFrames.OnEvent(event);
            </OnEvent>
            <OnUpdate>
                EnemyFrames.VerifyZoneUpdate(arg1);
                EnemyFrames.GatherDataUpdate(arg1)
                EnemyFrames.UnitFramesUpdate(arg1)
                EnemyFrames.UnitsDisplayUpdate(arg1)
            </OnUpdate>
		</Scripts>
	</Frame>

    <!-- Individual Units -->
    <Button name="EnemyUnitTemplate" virtual="true" hidden="true">
        <Size>
            <AbsDimension x="100" y="40" />
        </Size>
        <Backdrop bgFile="Interface\Tooltips\UI-Tooltip-Background" edgeFile="Interface\Tooltips\UI-Tooltip-Border" tile="true">
			<EdgeSize>
				<AbsValue val="9"/>
			</EdgeSize>
			<TileSize>
				<AbsValue val="16" />
			</TileSize>
			<BackgroundInsets>
				<AbsInset left="3" right="3" top="3" bottom="3"/>
			</BackgroundInsets>
		</Backdrop>
        <Layers>
            <Layer level="OVERLAY">
                <!-- Name -->
                <FontString name="$parentPlayerName" inherits="GameFontNormalSmall" text="PLAYERNAME">
                    <Anchors>
                        <Anchor point="TOP">
                            <Offset>
                                <AbsDimension x="0" y="-2" />
                            </Offset>
                        </Anchor>
                    </Anchors>
                </FontString>
            </Layer>
        </Layers>
		<Frames>
            <!-- HP bar -->
			<StatusBar name="$parentHealth">
				<Size>
					<AbsDimension x="94" y="17"/>
				</Size>
				<Anchors>
					<Anchor point="TOP">
						<Offset>
							<AbsDimension x="0" y="-13"/>
						</Offset>
					</Anchor>
				</Anchors>
				<BarTexture file="Interface\TargetingFrame\UI-StatusBar"/>
				<BarColor r="0.0" g="1.0" b="0.0"/>
			</StatusBar>
            <!-- Power Bar -->
			<StatusBar name="$parentPower">
				<Size>
					<AbsDimension x="94" y="7"/>
				</Size>
				<Anchors>
					<Anchor point="TOP">
						<Offset>
							<AbsDimension x="0" y="-30"/>
						</Offset>
					</Anchor>
				</Anchors>
				<BarTexture file="Interface\TargetingFrame\UI-StatusBar"/>
			</StatusBar>
		</Frames>
        <Scripts>
            <OnLoad>
                this:RegisterForClicks("LeftButtonUp")
                this:SetBackdropColor(0.0, 0.0, 0.0)
            </OnLoad>
            <OnClick>
                EnemyFrames.UnitClickEvent(this)
            </OnClick>
        </Scripts>
    </Button>
    
    <!-- Dragable masterframe to contain the units -->
    <Frame name="EnemyUnits" parent="UIParent" hidden="false" movable="true">
        <Size>
            <AbsDimension x="80" y="15" />
        </Size>
		<Anchors>
            <Anchor point="CENTER" />
		</Anchors>
        <Scripts>
            <OnLoad>this:RegisterForDrag("RightButton");</OnLoad>
            <OnDragStart>this:StartMoving();</OnDragStart>
            <OnDragStop>this:StopMovingOrSizing();</OnDragStop>
        </Scripts>
        <Layers>
            <Layer level="OVERLAY">
                <!-- Name -->
                <FontString name="$parentPlayerName" inherits="GameFontNormalSmall" text="EnemyFrames">
                    <Anchors>
                        <Anchor point="TOP">
                            <Offset>
                                <AbsDimension x="0" y="-2" />
                            </Offset>
                        </Anchor>
                    </Anchors>
                </FontString>
            </Layer>
        </Layers>
    </Frame>

    <!-- Options frame -->
    <Frame name="EnemyFramesOptions" parent="UIParent" hidden="true">
        <Size>
            <AbsDimension x="300" y="200" />
        </Size>
        <Anchors>
            <Anchor point="CENTER" />
        </Anchors>
        <Backdrop bgFile="Interface\DialogFrame\UI-DialogBox-Background" edgeFile="Interface\DialogFrame\UI-DialogBox-Border" tile="true">
            <BackgroundInsets>
                <AbsInset left="11" right="12" top="12" bottom="11" />
            </BackgroundInsets>
            <TileSize>
                <AbsValue val="32" />
            </TileSize>
            <EdgeSize>
                <AbsValue val="32" />
            </EdgeSize>
        </Backdrop>
        <!-- Header bar & text -->
        <Layers>
            <Layer level="ARTWORK">
                <Texture name="$parentHeader" file="Interface\DialogFrame\UI-DialogBox-Header">
                    <Size>
                        <AbsDimension x="350" y="64"/>
                    </Size>
                    <Anchors>
                        <Anchor point="TOP">
                            <Offset>
                                <AbsDimension x="0" y="12"/>
                            </Offset>
                        </Anchor>
                    </Anchors>
                </Texture>
                <FontString name="$parentTitle" inherits="GameFontNormal" text="EnemyFrames Options">
                    <Anchors>
                        <Anchor point="TOP">
                            <Offset>
                                <AbsDimension x="0" y="-1"/>
                            </Offset>
                        </Anchor>
                    </Anchors>
                </FontString>
            </Layer>
		</Layers>
		<Frames>
            <!-- Close button -->
            <Button name="$parentCloseButton" inherits="UIPanelCloseButton">
                <Anchors>
                    <Anchor point="TOPRIGHT">
                        <Offset>
                            <AbsDimension x="-5" y="-5" />
                        </Offset>
                    </Anchor>
                </Anchors>
            </Button>

            <!-- Scan Targets -->
			<CheckButton name="$parentScanTargets" inherits="OptionsCheckButtonTemplate" enable="false">
				<Anchors>
					<Anchor point="TOPLEFT">
						<Offset>
							<AbsDimension x="25" y="-35"/>
						</Offset>
					</Anchor>
				</Anchors>
				<Scripts>
					<OnLoad>
						getglobal(this:GetName().."Text"):SetText(EnemyFrames.OptionScanTargets);
					</OnLoad>
					<OnClick>
                        if this:GetChecked() ~= nil then
                            EFOptions.ScanTargets = true
                        else
                            EFOptions.ScanTargets = false
                        end
					</OnClick>
                    <OnEnter>
                        GameTooltip:SetOwner(this, "ANCHOR_RIGHT")
                        GameTooltip:SetText(EnemyFrames.OptionScanTargetsTip, nil, nil, nil, nil, 1)
                        GameTooltip:Show()
                    </OnEnter>
                    <OnLeave>
                        GameTooltip:Hide()
                    </OnLeave>
				</Scripts>
			</CheckButton>
            
            <!-- # of frames -->
            <Slider name="$parentMaxFrames" inherits="OptionsSliderTemplate">
				<Size>
					<AbsDimension x="200" y="16"/>
				</Size>
				<Anchors>
					<Anchor point="TOP">
						<Offset>
							<AbsDimension x="0" y="-80" />
						</Offset>
					</Anchor>
				</Anchors>
				<Scripts>
					<OnLoad>
						getglobal(this:GetName().."Text"):SetText(EnemyFrames.OptionMaxFrames);
						getglobal(this:GetName().."High"):SetText(tostring(EnemyFrames.MaxDisplayUnits));
						getglobal(this:GetName().."Low"):SetText("5");
						this:SetMinMaxValues(5,EnemyFrames.MaxDisplayUnits);
						this:SetValueStep(1);
					</OnLoad>
					<OnValueChanged>
						getglobal(this:GetName().."Value"):SetText(this:GetValue());
                        EnemyFrames.MaxFramesChanged(this:GetValue())
					</OnValueChanged>
                    <OnEnter>
                        GameTooltip:SetOwner(this, "ANCHOR_RIGHT")
                        GameTooltip:SetText(EnemyFrames.OptionMaxFramesTip, nil, nil, nil, nil, 1)
                        GameTooltip:Show()
                    </OnEnter>
                    <OnLeave>
                        GameTooltip:Hide()
                    </OnLeave>
				</Scripts>
                <Layers>
                    <Layer level="ARTWORK">
                        <FontString name="$parentValue" inherits="GameFontHighlightSmall" text="VALUE">
                            <Anchors>
                                <Anchor point="TOPLEFT" relativePoint="BOTTOM">
                                    <Offset>
                                        <AbsDimension x="0" y="3"/>
                                    </Offset>
                                </Anchor>
                            </Anchors>
                        </FontString>
                    </Layer>
                </Layers>
			</Slider>
        </Frames>
    </Frame>
</Ui>
